<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Home. strcode</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>

<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container">
      <header>
      
<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">strcode</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="articles/index.html">Articles</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
      
      </header>

      <div class="row">
  <div class="col-md-9">
    
<h1 id="readme">README</h1>
<p><a href="https://travis-ci.org/lorenzwalthert/strcode"><img src="https://travis-ci.org/lorenzwalthert/strcode.svg?branch=master" alt="Build Status"></a> <a href="http://www.repostatus.org/#wip"><img src="http://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP ? Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a> <a href="https://cran.r-project.org/package=strcode"><img src="http://www.r-pkg.org/badges/version/strcode" alt="CRAN_Status_Badge"></a> <a href="commits/master"><img src="https://img.shields.io/badge/Package%20version-0.2.0-orange.svg?style=flat-square" alt="packageversion"></a></p>
<p>The <code>strcode</code> (short for structuring code) package contains tools to organize and abstract your code better. It consists of</p>
<ul>
<li>An <a href="https://rstudio.github.io/rstudioaddins/">RStudio Add-in</a> that lets you quickly add code block separators and titles (possibly with unique identifiers) to divide your work into sections. The titles are recognized as sections by RStudio, which enhances the coding experience further.</li>
<li>A function <code>sum_str</code> that summarizes the code structure based on the separators and their comments added with the Add-in. For one or more files, it can cat the structure to the console or a file.</li>
<li>An <a href="https://rstudio.github.io/rstudioaddins/">RStudio Add-in</a> that lets you insert a code anchor, that is, a hash sequence which can be used to uniquely identify a line in a large code base.</li>
</ul>
<!-- You can learn more about structuring code in [Bono Usu](https://github.com/lorenzwalthert/bonousu/blob/devel/docs/commenting-code.html), 
a guide for good practice in R programming. --><p><img src="/Users/lorenz/datasciencecoursera/strcode/demos/strcode_v0.2.0_video_to_gif2_large.gif" width="650px"></p>
<h1 id="installation">Installation</h1>
<p>You can install the package from GitHub.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools::<span class="kw">install_github</span>(<span class="st">"lorenzwalthert/strcode"</span>)</code></pre></div>
<h1 id="structuring-code">Structuring code</h1>
<p>We suggest three levels of granularity for code structuring, whereas higher-level blocks can contain lower-level blocks.</p>
<ul>
<li>level 1 sections, which are high-level blocks that can be separated as follows:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#   ____________________________________________________________________________</span>
<span class="co">#   A title                                                                 ####</span></code></pre></div>
<ul>
<li>level 2 sections, which are medium-level blocks that can be separated as follows:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##  ............................................................................
##  A subtitle                                                              ####</code></pre></div>
<ul>
<li>level 3 sections, which are low-level blocks that can be separated as follows:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
### One more                                                                ####</code></pre></div>
<p>You can notice from the above that</p>
<ul>
<li>The number of <code>#</code> used in front of the break character (<code>___</code>, <code>...</code>, <code>. .</code>) corresponds to the level of granularity that is separated.</li>
<li>The breaks characters <code>___</code>, <code>...</code>, <code>. .</code> were chosen such that they reflect the level of granularity, namely <code>___</code> has a much higher visual density than <code>. .</code>.</li>
<li>Each block has an (optional) short title on what that block is about.</li>
<li>Every title ends with <code>####</code>. Therefore, the titles are recognized by RStudio as <a href="https://support.rstudio.com/hc/en-us/articles/200484568-Code-Folding-and-Sections">sections</a>. This has the advantages that you can get a quick summary of your code in Rstudio’s code pane and you can fold sections as you can fold code or function declarations or if statements. See the pictures below for details.</li>
</ul>
<p>The separators all have length 80. The value is looked up in the global option <code>strcode$char_length</code> and can therefore be changed by the user.</p>
<p>By default, breaks and titles are inserted via a Shiny Gadget, but this default can be overridden by setting the option <code>strcode$insert_with_shiny</code> to <code>FALSE</code> and hence only inserting the break.</p>
<h1 id="anchoring-sections">Anchoring sections</h1>
<p>Sometimes it is required to refer to a code section, which can be done by title. A better way, however, is to use a unique hash sequence - let us call it a code anchor - to create an arguably unique reference to that section. A code anchor in <code>strcode</code> is enclosed by <code>#&lt;</code> and <code>&gt;#</code> so all anchors can be found using regular expressions. You can add section breaks that include a hash. That might look like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##  .................. #&lt; 685c967d4e78477623b861d533d0937a &gt;# ..................
##  An anchored section                                                     ####</code></pre></div>
<h1 id="insert-a-code-anchor">Insert a code anchor</h1>
<p>Code anchors might prove helpful in other situations where one want to anchor a single line. That is also possible with <code>strcode</code>. An example of a code anchor is the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&lt; 56f5139874167f4f5635b42c37fd6594 &gt;#</span>
this_is_a_super_important_but_hard_to_describe_line_so_let_me_anchor_it</code></pre></div>
<p>The hash sequences in strcode are produced with the R package <a href="https://github.com/eddelbuettel/digest">digest</a>.</p>
<h1 id="summarizing-code">Summarizing code</h1>
<p>Once code has been structured by adding sections (as above), it can easily be summarized or represented in a compact and abstract form. This is particularly handy when the codebase is large, when a lot of people work on the code or when new people join a project. The function <code>sum_str</code> is designed for the purpose of extracting separators and respective comments, in order to provide high level code summaries. It is highly customizable and flexible, with a host of options. Thanks to RStudio’s API, you can even create summaries of the file you are working on, simply by typing <code><a href="reference/sum_str.html">sum_str()</a></code> in the console. The file presented in the example section below can be summarized as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/sum_str.html">sum_str</a></span>(<span class="dt">path_in =</span> <span class="st">"placeholder_code/example.R"</span>, 
        <span class="dt">file_out =</span> <span class="st">""</span>,
        <span class="dt">width =</span> <span class="dv">40</span>,
        <span class="dt">granularity =</span> <span class="dv">2</span>,
        <span class="dt">lowest_sep =</span> <span class="ot">FALSE</span>, 
        <span class="dt">header =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Summarized structure of placeholder_code/example.R</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; line  level section</span>
<span class="co">#&gt; 2    #   _</span>
<span class="co">#&gt; 3    #   function test</span>
<span class="co">#&gt; 6    ##  -A: pre-processing</span>
<span class="co">#&gt; 57   ##  B: actual function</span>
<span class="co">#&gt; 83   #   ____________________________________</span>
<span class="co">#&gt; 84   #   function test2</span>
<span class="co">#&gt; 87   ##  A: pre-processing</span>
<span class="co">#&gt; 138  ##  B: actual function</span>
<span class="co">#&gt; 169  ##  test</span></code></pre></div>
<ul>
<li>
<code>path_in</code> specifies a directory or filenames for looking for content to summarize.</li>
<li>
<code>file_out</code> indicates where to dump the output.</li>
<li>
<code>width</code> gives the width of the output in characters.</li>
<li>
<code>granularity = 2</code>indicates that we want two of three levels of granularity to be contained in the summary and don’t include level 3 comments.</li>
<li>Similarly, we use <code>lowest_sep = FALSE</code> to indicate that we want lowest separators (given <code>granularity</code>) to be omitted between the titles of the sections.</li>
<li>
<code>header</code> was set to <code>TRUE</code>, so the column names were reported as well. Note that they are slightly off since knitr uses a different tab length. In the R console and more imporantly in the outputed file, they are aliged.</li>
</ul>
<h2 id="example-of-improved-legibility">Example of improved legibility</h2>
<p>To demonstrate the improvement in legibility, we give an extended example with some placeholder code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#   ____________________________________________________________________________</span>
<span class="co">#   function test                                                           ####</span>
test &lt;-<span class="st"> </span>function(x) {
##  ............................................................................
##  A: pre-processing                                                       ####
### .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
### a: assertive tests                                                      ####
  <span class="co"># x</span>
  if(<span class="kw">missing</span>(x) ||<span class="st"> </span><span class="kw">is.null</span>(x)){ 
    x &lt;-<span class="st"> </span><span class="kw">character</span>()
  }
  <span class="kw">assert</span>(
    <span class="co"># use check within assert</span>
    <span class="kw">check_character</span>(x),
    <span class="kw">check_factor</span>(x),
    <span class="kw">check_numeric</span>(x)
  )
  
  <span class="co"># levels </span>
  if(!<span class="kw">missing</span>(levels)){
    <span class="kw">assert</span>(
      <span class="kw">check_character</span>(levels),
      <span class="kw">check_integer</span>(levels),
      <span class="kw">check_numeric</span>(levels))
    levels &lt;-<span class="st"> </span><span class="kw">na.omit</span>(levels)
    
  }
  
  <span class="co"># labels</span>
  if(!<span class="kw">missing</span>(labels)){
    <span class="kw">assert</span>(
      <span class="kw">check_character</span>(labels),
      <span class="kw">check_numeric</span>(labels),
      <span class="kw">check_factor</span>(labels)
      )
  }
  
### .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
### b: coercion / remove missing                                            ####
  x &lt;-<span class="st"> </span><span class="kw">as.character</span>(x)
  uniq_x &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">na.omit</span>(x), <span class="dt">nmax =</span> nmax)
  
### .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
### c: warnings                                                             ####
  
  if(<span class="kw">length</span>(breaks) ==<span class="st"> </span><span class="dv">1</span>) {
    if(breaks &gt;<span class="st"> </span><span class="kw">max</span>(x) -<span class="st"> </span><span class="kw">min</span>(x) +<span class="st"> </span><span class="dv">1</span>) {
      <span class="kw">stop</span>(<span class="st">"range too small for the number of breaks specified"</span>)
    }
    if(<span class="kw">length</span>(x) &lt;=<span class="st"> </span>breaks) {
      <span class="kw">warning</span>(<span class="st">"breaks is a scalar not smaller than the length of x"</span>)
    }
  }  
  
##  ............................................................................
##  B: actual function                                                      ####
   variable &lt;<span class="st"> </span>-<span class="kw">paste</span>(<span class="st">"T"</span>, period, <span class="st">"nog_"</span>, sector, <span class="dt">sep =</span> <span class="st">""</span>)
   variable &lt;-<span class="st"> </span><span class="kw">paste</span>(variable, <span class="st">"=="</span>, <span class="dv">1</span>, <span class="dt">sep =</span> <span class="st">""</span>)
        
   arg&lt;-<span class="kw">substitute</span>(variable)
   r&lt;-<span class="kw">eval</span>(arg, idlist.data[[<span class="dv">1</span>]])
   a&lt;&lt;-<span class="dv">1</span>
   
   was_factor &lt;-<span class="st"> </span><span class="ot">FALSE</span>
   if (<span class="kw">is.factor</span>(yes)) {
     yes &lt;-<span class="st"> </span><span class="kw">as.character</span>(yes)
     was_factor &lt;-<span class="st"> </span><span class="ot">TRUE</span>
   } 
   if (<span class="kw">is.factor</span>(no)) {
     no &lt;-<span class="st"> </span><span class="kw">as.character</span>(no)
     was_factor &lt;-<span class="st"> </span><span class="ot">TRUE</span>
   }
   out &lt;-<span class="st"> </span><span class="kw">ifelse</span>(test, yes, no)
   if(was_factor) {
     <span class="kw">cfactor</span>(out)
   } else {
     out
   } 
   
##  ............................................................................
}
<span class="co">#   ____________________________________________________________________________</span>
<span class="co">#   function test2                                                          ####</span>
test2 &lt;-<span class="st"> </span>function(x) {
##  ............................................................................
##  A: pre-processing                                                       ####
### .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
### a: assertive tests                                                      ####
  <span class="co"># x</span>
  if(<span class="kw">missing</span>(x) ||<span class="st"> </span><span class="kw">is.null</span>(x)){ 
    x &lt;-<span class="st"> </span><span class="kw">character</span>()
  }
  <span class="kw">assert</span>(
    <span class="co"># use check within assert</span>
    <span class="kw">check_character</span>(x),
    <span class="kw">check_factor</span>(x),
    <span class="kw">check_numeric</span>(x)
  )
  
  <span class="co"># levels </span>
  if(!<span class="kw">missing</span>(levels)){
    <span class="kw">assert</span>(
      <span class="kw">check_character</span>(levels),
      <span class="kw">check_integer</span>(levels),
      <span class="kw">check_numeric</span>(levels))
    levels &lt;-<span class="st"> </span><span class="kw">na.omit</span>(levels)
    
  }
  
  <span class="co"># labels</span>
  if(!<span class="kw">missing</span>(labels)){
    <span class="kw">assert</span>(
      <span class="kw">check_character</span>(labels),
      <span class="kw">check_numeric</span>(labels),
      <span class="kw">check_factor</span>(labels)
      )
  }
  
### .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
### b: coercion / remove missing                                            ####
  x &lt;-<span class="st"> </span><span class="kw">as.character</span>(x)
  uniq_x &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">na.omit</span>(x), <span class="dt">nmax =</span> nmax)
  
### .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
### c: warnings                                                             ####
  
  if(<span class="kw">length</span>(breaks) ==<span class="st"> </span><span class="dv">1</span>) {
    if(breaks &gt;<span class="st"> </span><span class="kw">max</span>(x) -<span class="st"> </span><span class="kw">min</span>(x) +<span class="st"> </span><span class="dv">1</span>) {
      <span class="kw">stop</span>(<span class="st">"range too small for the number of breaks specified"</span>)
    }
    if(<span class="kw">length</span>(x) &lt;=<span class="st"> </span>breaks) {
      <span class="kw">warning</span>(<span class="st">"breaks is a scalar not smaller than the length of x"</span>)
    }
  }  
  
##  ............................................................................
##  B: actual function                                                      ####
   variable &lt;<span class="st"> </span>-<span class="kw">paste</span>(<span class="st">"T"</span>, period, <span class="st">"nog_"</span>, sector, <span class="dt">sep =</span> <span class="st">""</span>)
   variable &lt;-<span class="st"> </span><span class="kw">paste</span>(variable, <span class="st">"=="</span>, <span class="dv">1</span>, <span class="dt">sep =</span> <span class="st">""</span>)
        
   arg&lt;-<span class="kw">substitute</span>(variable)
   r&lt;-<span class="kw">eval</span>(arg, idlist.data[[<span class="dv">1</span>]])
   a&lt;&lt;-<span class="dv">1</span>
   
   was_factor &lt;-<span class="st"> </span><span class="ot">FALSE</span>
   if (<span class="kw">is.factor</span>(yes)) {
     yes &lt;-<span class="st"> </span><span class="kw">as.character</span>(yes)
     was_factor &lt;-<span class="st"> </span><span class="ot">TRUE</span>
   } 
   if (<span class="kw">is.factor</span>(no)) {
     no &lt;-<span class="st"> </span><span class="kw">as.character</span>(no)
     was_factor &lt;-<span class="st"> </span><span class="ot">TRUE</span>
   }
   out &lt;-<span class="st"> </span><span class="kw">ifelse</span>(test, yes, no)
   if(was_factor) {
     <span class="kw">cfactor</span>(out)
   } else {
     out
   } 
   
##  ............................................................................
}</code></pre></div>

  </div>
</div>

      <footer>
      <p>Built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>. Styled with <a href="http://getbootstrap.com">Bootstrap 3</a>.</p>
      </footer>
   </div>

  </body>
</html>
